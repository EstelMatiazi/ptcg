<ptcg-content [loading]="loading">
  <mat-toolbar>
    <mat-toolbar-row>
      <h1>Profile summary</h1>

      <span class="ptcg-u-spacer"></span>

      <div *ngIf="owner$ | async ; then ownerActions ; else visitorActions"></div>
      <ng-template #ownerActions>
        <button mat-raised-button color="primary" (click)="editAvatars(userId)">
          Edit avatars
        </button>
        <button mat-raised-button color="primary" (click)="changePassword()">
          Change password
        </button>
      </ng-template>
      <ng-template #visitorActions>
        <button mat-raised-button color="primary" [routerLink]="['/message', userId]">
          Send message
        </button>
      </ng-template>
    </mat-toolbar-row>
  </mat-toolbar>

  <div class="ptcg-user-details ptcg-u-padding" *ngIf="user$ | async; let user">
    <mat-card class="example-card">
      <mat-card-content>
        <div class="ptcg-profile-avatar">
          <ptcg-avatar type="profile" openPopup="true" [avatarFile]="user.avatarFile">
          </ptcg-avatar>
        </div>
        <div class="ptcg-profile-summary">
          <table>
            <tr>
              <th>Name</th>
              <td>{{ user.name }}</td>
            </tr>
            <tr>
              <th>Ranking</th>
              <td><ptcg-rank [ranking]="user.ranking" [rank]="user.rank"></ptcg-rank></td>
            </tr>
            <tr>
              <th>Registered</th>
              <td>
                {{ user.registered | date }}
              </td>
            </tr>
            <tr>
              <th>Last seen</th>
              <td>
                <span *ngIf="!user.connected; else connected">
                  {{ user.lastSeen | date }}
                </span>
                <ng-template #connected>
                  <ptcg-badge>Online</ptcg-badge>
                </ng-template>
              </td>
            </tr>
          </table>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="ptcg-recent-matches" *ngIf="user$ | async; let user">
    <ptcg-match-table [userId]="user.userId"></ptcg-match-table>
  </div>

</ptcg-content>
